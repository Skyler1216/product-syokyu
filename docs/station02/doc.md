# 要件定義書

## 1. 概要

- **プロジェクト名**：ハリネズミ健康管理アプリ『Hariny（ハリニー）』
- **作成日**：2025 年 9 月 4 日
- **作成者**：城田 航
- **目的**：
  - 入門編で整理した要求をもとに、PoC 開発に向けた要件を明文化し、設計・実装に着手できる状態にする。

---

## 2. 要求から要件への変換

| 区分   | 要求（入門編）                                             | 要件（今回作成）                                                                       |
| ------ | ---------------------------------------------------------- | -------------------------------------------------------------------------------------- |
| 機能   | 飼い主が個体情報を管理したい                               | 名前・写真・性別・生年月日を登録/編集でき、一覧表示で個体を選択可能                    |
| 機能   | 健康情報（体重・食事など）を記録したい                     | 体重は数値入力、グラフ自動生成。食事は自由入力＋履歴表示。排泄物はチェック形式で記録   |
| 機能   | 通院記録を残したい                                         | 通院日・診断内容・写真/PDF を添付して保存、履歴閲覧可能                                |
| 機能   | 投薬や掃除を忘れないようにしたい                           | リマインダー登録・削除が可能で、指定時刻に画面通知を表示                               |
| 機能   | 緊急時に病院連絡先を確認したい                             | 病院名・電話番号を登録し、ワンタップで電話アプリ起動                                   |
| 機能   | 飼育知識を届けたい                                         | 協会管理者が投稿した記事をアプリ内で一覧表示・閲覧可能                                 |
| 機能   | 協会に匿名データを送りたい                                 | 記録保存時に Supabase 経由で協会 DB へ匿名データ送信                                   |
| 機能   | 協会が提供する病院情報を活用したい                         | Google マイマップ連携（協会提供 URL）を利用して病院 MAP を表示                         |
| 機能   | 協会側に集まったデータを分析・研究に活用できるようにしたい | 協会管理者向けにデータ閲覧・集計・CSV 出力機能を提供し、統計分析や研究利用を可能にする |
| 非機能 | アプリを直感的に使いたい                                   | モバイルファースト UI、1 画面 1 タスクに絞った簡易 UI                                  |
| 非機能 | 安心して使いたい                                           | Supabase Auth による認証、RLS でデータ分離                                             |

---

## 3. 機能要件

- **機能 1：個体管理**

  - 概要：飼い主が飼育しているハリネズミの個体情報を管理
  - 詳細仕様：名前・写真・性別・生年月日を登録/編集/削除。最大 10 頭まで管理可能
  - 入出力条件：入力＝フォーム、出力＝一覧表示・個体詳細画面
  - 例外・制約：必須入力は名前のみ、他は任意

- **機能 2：健康記録**

  - 概要：体重・食事・排泄などの記録
  - 詳細仕様：体重は数値＋自動グラフ化、食事はテキスト入力、排泄物は「正常/軟便/血便」チェック
  - 入出力条件：入力＝記録フォーム、出力＝履歴一覧＋体重グラフ
  - 例外・制約：体重は数値のみ、食事は 100 文字まで

- **機能 3：通院・治療記録**

  - 概要：診療記録の保存と参照
  - 詳細仕様：日付・診断内容・投薬指示・写真/PDF 添付
  - 入出力条件：入力＝フォーム、出力＝通院履歴リスト
  - 例外・制約：ファイル添付は 10MB まで

- **機能 4：お世話リマインダー**

  - 概要：掃除・投薬・給餌などをリマインド
  - 詳細仕様：タイトル・時刻・繰り返し設定、通知表示
  - 入出力条件：入力＝設定画面、出力＝通知（画面上）
  - 例外・制約：プッシュ通知は PoC では対象外

- **機能 5：緊急連絡先管理**

  - 概要：病院の連絡先登録と即時表示
  - 詳細仕様：病院名・電話番号を登録。ボタン押下で電話発信
  - 入出力条件：入力＝登録フォーム、出力＝一覧表示
  - 例外・制約：電話番号は 10〜15 桁

- **機能 6：飼育知識配信**

  - 概要：協会側から飼い主へ情報配信
  - 詳細仕様：協会管理者が記事を投稿 → アプリ内で閲覧可能
  - 入出力条件：入力＝管理者投稿、出力＝記事一覧・詳細
  - 例外・制約：記事は Markdown 簡易対応

- **機能 7：協会データ送信**

  - 概要：記録保存と同時に協会に匿名データ送信
  - 詳細仕様：個体 ID を匿名化（UUID 変換）し、Supabase Functions 経由で協会 DB に保存
  - 入出力条件：入力＝健康記録等、出力＝協会 DB
  - 例外・制約：送信失敗時は再送処理あり

- **機能 8：Google マイマップ連携**

  - 概要：協会が提供する病院情報をマップ表示
  - 詳細仕様：協会提供 URL を利用し、病院 MAP を埋め込み表示
  - 入出力条件：入力＝協会 URL、出力＝アプリ内マップ画面
  - 例外・制約：外部サービス仕様に依存

- **機能 9：協会データ活用**
  - 概要：協会が収集したデータを活用できる仕組み
  - 詳細仕様：協会管理者向けにデータ閲覧・集計・CSV 出力機能を提供
  - 入出力条件：入力＝アプリから送信される匿名データ、出力＝管理画面・CSV
  - 例外・制約：統計処理や研究利用は協会の運用に依存

---

## 4. 非機能要件

- **性能要件**：
  - ページ表示 2 秒以内
  - 同時接続数：50 ユーザー（PoC 段階）
- **セキュリティ要件**：
  - Supabase Auth（メール＋パスワード認証）
  - 通信は HTTPS 必須
  - データベースは RLS 有効化
- **運用要件**：
  - バックアップ：Supabase 自動バックアップ利用
  - ログ保存：30 日
- **その他**：
  - UI はモバイルファースト
  - PWA 対応、オフラインはキャッシュレベルで一部対応

---

## 5. スコープ（今回やること／やらないこと）

- **やること（IN スコープ）**
  - 個体管理、健康記録、通院記録、リマインダー、緊急連絡先、協会データ送信
- **やらないこと（OUT スコープ）**
  - プッシュ通知（PoC 外）
  - アルバム機能
  - 他ペット種対応
  - App Store / Google Play 配信

---

## 6. 前提条件・制約

- 利用する技術やサービス：Next.js, Supabase, Vercel
- 対象プラットフォーム：スマホブラウザ（PWA）
- 開発期間：未定（PoCは3か月想定）
- その他制約：
  - 予算は無料枠利用、個人開発体制
  - PWAリンク配布（App Store／Google Playは対象外）
  - QRコードでユーザーに案内
---

## 7. リスク・懸念事項

- Supabase 無料枠の制限（DB サイズ、同時接続数）
- 個人開発による工数不足
- プッシュ通知未対応によるユーザー満足度低下
- 多頭飼いの上限設定が不明確

---

## 8. 用語定義

| 用語     | 定義                                                                       |
| -------- | -------------------------------------------------------------------------- |
| PoC      | Proof of Concept（概念実証）                                               |
| スコープ | プロジェクトで対応する範囲                                                 |
| PWA      | Progressive Web App。インストール不要でアプリのように動作する Web アプリ   |
| RLS      | Row Level Security。ユーザーごとに DB の行レベルでアクセス制御を行う仕組み |
